if smsa=0 then smsa=9999;
*step1 - use smsa-recodes from cg1.sas reading county eq files;
*short version drops all 9999 assignments;

if state=1   and cgroup=1   then smsa=2650;
if state=1   and cgroup=8   then smsa=1000;
if state=1   and cgroup=21   then smsa=5160;
if state=5   and cgroup=13   then smsa=2720;
if state=5   and cgroup=16   then smsa=6240;
if state=6   and cgroup=6   then smsa=9340;
if state=6   and cgroup=50   then smsa=6780;
if state=9   and cgroup=2   then smsa=8040;
if state=9   and cgroup=8   then smsa=5480;
if state=9   and cgroup=9   then smsa=5480;
if state=9   and cgroup=19   then smsa=3280;
if state=9   and cgroup=21   then smsa=1170;
if state=9   and cgroup=23   then smsa=8880;
if state=12   and cgroup=3   then smsa=6015;
if state=12   and cgroup=53   then smsa=5000;
if state=13   and cgroup=10   then smsa=520;
if state=13   and cgroup=13   then smsa=4680;
if state=18   and cgroup=27   then smsa=1020;
if state=18   and cgroup=29   then smsa=8320;
if state=18   and cgroup=31   then smsa=2440;
if state=18   and cgroup=34   then smsa=4520;
if state=18   and cgroup=35   then smsa=4520;
if state=19   and cgroup=13   then smsa=3500;
if state=20   and cgroup=15   then smsa=4150;
if state=21   and cgroup=2   then smsa=1640;
if state=21   and cgroup=5   then smsa=4520;
if state=21   and cgroup=8   then smsa=4280;
if state=21   and cgroup=11   then smsa=3400;
if state=21   and cgroup=22   then smsa=1660;
if state=22   and cgroup=8   then smsa=3960;
if state=22   and cgroup=25   then smsa=5560;
if state=24   and cgroup=1   then smsa=1900;
if state=25   and cgroup=9   then smsa=9240;
if state=25   and cgroup=10   then smsa=2600;
if state=25   and cgroup=11   then smsa=4560;
if state=25   and cgroup=15   then smsa=1120;
if state=25   and cgroup=26   then smsa=1120;
if state=25   and cgroup=32   then smsa=1200;
if state=26   and cgroup=24   then smsa=2640;
if state=26   and cgroup=26   then smsa=3720;
if state=27   and cgroup=13   then smsa=6820;
if state=27   and cgroup=25   then smsa=6980;
if state=28   and cgroup=10   then smsa=3560;
if state=31   and cgroup=7   then smsa=5920;
if state=33   and cgroup=3   then smsa=5350;
if state=35   and cgroup=7   then smsa=4100;
if state=36   and cgroup=16   then smsa=8160;
if state=36   and cgroup=21   then smsa=6840;
if state=36   and cgroup=34   then smsa=6460;
if state=37   and cgroup=2   then smsa=480;
if state=37   and cgroup=13   then smsa=1300;
if state=37   and cgroup=19   then smsa=6640;
if state=38   and cgroup=2   then smsa=1010;
if state=38   and cgroup=4   then smsa=2520;
if state=39   and cgroup=38   then smsa=8080;
if state=39   and cgroup=39   then smsa=9000;
if state=39   and cgroup=59   then smsa=3400;
if state=39   and cgroup=61   then smsa=6020;
if state=44   and cgroup=4   then smsa=6480;
if state=45   and cgroup=2   then smsa=3160;
if state=47   and cgroup=7   then smsa=1660;
if state=47   and cgroup=27   then smsa=3660;
if state=48   and cgroup=28   then smsa=5040;
if state=48   and cgroup=29   then smsa=7200;
if state=48   and cgroup=34   then smsa=4080;
if state=48   and cgroup=42   then smsa=7240;
if state=48   and cgroup=50   then smsa=1260;
if state=48   and cgroup=64   then smsa=3360;
if state=54   and cgroup=1   then smsa=9000;
if state=54   and cgroup=4   then smsa=6020;
if state=54   and cgroup=9   then smsa=1480;
if state=55   and cgroup=14   then smsa=3870;

*step 2 -- hand entered fixups for top 125 cities;
*start by assigning all smas to msa=2000 version;
msa=smsa;

if state=35 and cgroup=6 then msa=200;  
if state=34 and smsa=240 then msa=9999; 
if state=26 and cgroup in (32,58) then msa=240;
if state=13 and cgroup in (2,10) then msa=520;
if state=34 and (1<=cgroup<=9) then msa=875;
if state=16 and cgroup=2 then msa=1080;
if state=9  and cgroup=6 then msa=1160;
if state=37 and cgroup=39 then msa=1520;
if state=45 and cgroup=6  then msa=1520;
if state=17 and cgroup=4 then msa=1600;
if state=21 and cgroup=2 then msa=1640;
if smsa=4440 then msa=1680;

if state=48 and cgroup in (21,25) then msa=2800;
if state=39 and cgroup=45 then msa=2000;
if state=8  and cgroup=10 then msa=1125;
if state=18 and cgroup=12 then msa=2760;
if state=26 and cgroup=12 then msa=3000;
if state=37 and cgroup in (13,7) then msa=3120;
if state=45 and cgroup=1 then msa=3160;
if state=42 and cgroup=45 then msa=3240;
if smsa in (1170,5440) then msa=3280;
if state=9  and cgroup=11 then msa=3280;
if state=48 and cgroup=62 then msa=1145;
if state=18 and cgroup=20 then msa=3480;
if state=28 and cgroup=1  then msa=3560;

if state=26 and cgroup=29 then msa=3270;
if state=5  and cgroup=7  then msa=4400;
if state=18 and cgroup in (34,35) then msa=4520;
if state=34 and cgroup in (26,27,28,29,30,31,51) then msa=5015;
if state=27 and cgroup=25 then msa=5120;
if state=34 and (32<=cgroup<=37) then msa=5190;
if state=9  and cgroup in (8,9) then msa=5480;
if state=22 and cgroup in (19,25) then msa=5560;

if state=51 and cgroup in (20,21) then msa=5720;
if state=6  and cgroup in (16,17,18) then msa=5775;
if state=31 and cgroup=7  then msa=5920;
if smsa=360 then msa=5945;
if state=12 and cgroup=13 then msa=5960;
if state=4  and cgroup=7  then msa=6200;
if state=42 and cgroup in (21,34) then msa=6280;
if state=41 and cgroup=7  then msa=6440;
if state=44 and cgroup=4  then msa=6480;
if state=25 and cgroup in (34,35) then msa=6480;
if smsa=2480 then msa=6480;
if state=37 and cgroup in (19,20) then msa=6640;
if smsa=6140 then msa=6760;
if state=36 and cgroup=22 then msa=6840;

if state=6  and cgroup=11 then msa=9999;
if state=6  and cgroup=7  then msa=6920;
if state=48 and cgroup=42 then msa=7240;
if smsa=1140 then msa=7510;
if smsa=5745 then msa=7560;
if state=25 and cgroup=2  then msa=8000;
if state=36 and cgroup=18 then msa=8160;
if state=26 and cgroup=33 then msa=9999;
if smsa=6000 then msa=8735;
if state=51 and cgroup in (2,27) then msa=8840;
if state=25 and cgroup=7  then msa=9240;
if state=39 and cgroup=26 then msa=9320;
if state=25 and cgroup in (15,25) then msa=1120;


*identify top 125 cities;
top125=0;
if msa=80  then top125=1;
else if msa=160  then top125=1;
else if msa=200  then top125=1;
else if msa=240  then top125=1;
else if msa=440  then top125=1;
else if msa=520  then top125=1;
else if msa=600  then top125=1;
else if msa=640  then top125=1;
else if msa=680  then top125=1;
else if msa=720  then top125=1;
else if msa=760  then top125=1;
else if msa=875  then top125=1;
else if msa=1000  then top125=1;
else if msa=1080  then top125=1;
else if msa=1120  then top125=1;
else if msa=1160  then top125=1;
else if msa=1280  then top125=1;
else if msa=1440  then top125=1;
else if msa=1520  then top125=1;
else if msa=1560  then top125=1;
else if msa=1600  then top125=1;
else if msa=1640  then top125=1;
else if msa=1680  then top125=1;
else if msa=1720  then top125=1;
else if msa=1760  then top125=1;
else if msa=1840  then top125=1;
else if msa=1920  then top125=1;
else if msa=2000  then top125=1;
else if msa=2020  then top125=1;
else if msa=2080  then top125=1;
else if msa=2120  then top125=1;
else if msa=2160  then top125=1;
else if msa=2320  then top125=1;
else if msa=2640  then top125=1;
else if msa=2680  then top125=1;
else if msa=2700  then top125=1;
else if msa=2760  then top125=1;
else if msa=2800  then top125=1;
else if msa=2840  then top125=1;
else if msa=2960  then top125=1;
else if msa=3000  then top125=1;
else if msa=3120  then top125=1;
else if msa=3160  then top125=1;
else if msa=3240  then top125=1;
else if msa=3280  then top125=1;
else if msa=3320  then top125=1;
else if msa=3360  then top125=1;
else if msa=3480  then top125=1;
else if msa=3560  then top125=1;
else if msa=3600  then top125=1;
else if msa=3640  then top125=1;
else if msa=3660  then top125=1;
else if msa=3720  then top125=1;
else if msa=3760  then top125=1;
else if msa=3840  then top125=1;
else if msa=3980  then top125=1;
else if msa=4000  then top125=1;
else if msa=4040  then top125=1;
else if msa=4120  then top125=1;
else if msa=4280  then top125=1;
else if msa=4400  then top125=1;
else if msa=4480  then top125=1;
else if msa=4520  then top125=1;
else if msa=4720  then top125=1;
else if msa=4880  then top125=1;
else if msa=4900  then top125=1;
else if msa=4920  then top125=1;
else if msa=5000  then top125=1;
else if msa=5015  then top125=1;
else if msa=5080  then top125=1;
else if msa=5120  then top125=1;
else if msa=5160  then top125=1;
else if msa=5170  then top125=1;
else if msa=5190  then top125=1;
else if msa=5360  then top125=1;
else if msa=5380  then top125=1;
else if msa=5480  then top125=1;
else if msa=5560  then top125=1;
else if msa=5600  then top125=1;
else if msa=5640  then top125=1;
else if msa=5720  then top125=1;
else if msa=5775  then top125=1;
else if msa=5880  then top125=1;
else if msa=5920  then top125=1;
else if msa=5945  then top125=1;
else if msa=5960  then top125=1;
else if msa=6080  then top125=1;
else if msa=6160  then top125=1;
else if msa=6200  then top125=1;
else if msa=6280  then top125=1;
else if msa=6440  then top125=1;
else if msa=6480  then top125=1;
else if msa=6640  then top125=1;
else if msa=6760  then top125=1;
else if msa=6780  then top125=1;
else if msa=6840  then top125=1;
else if msa=6920  then top125=1;
else if msa=7040  then top125=1;
else if msa=7160  then top125=1;`
else if msa=7240  then top125=1;
else if msa=7320  then top125=1;
else if msa=7360  then top125=1;
else if msa=7400  then top125=1;
else if msa=7440  then top125=1;
else if msa=7500  then top125=1;
else if msa=7510  then top125=1;
else if msa=7560  then top125=1;
else if msa=7600  then top125=1;
else if msa=7840  then top125=1;
else if msa=8000  then top125=1;
else if msa=8120  then top125=1;
else if msa=8160  then top125=1;
else if msa=8200  then top125=1;
else if msa=8280  then top125=1;
else if msa=8400  then top125=1;
else if msa=8520  then top125=1;
else if msa=8560  then top125=1;
else if msa=8720  then top125=1;
else if msa=8735  then top125=1;
else if msa=8840  then top125=1;
else if msa=8960  then top125=1;
else if msa=9040  then top125=1;
else if msa=9160  then top125=1;
else if msa=9240  then top125=1;
else if msa=9320  then top125=1;



