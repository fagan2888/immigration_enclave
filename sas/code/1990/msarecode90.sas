
if msa in (., 0, 9996, 9997, 9998, 9999) then msa=9999;
omsa=msa;

*step1 - use smsa-recodes from fixmsa.sas (based on 
smsa9997.sas);


*allocate mixed pumas to msa if 50% or more of pop in msa;
*smsa9997.sas createdfrom county eq file, edited by dc 07-2008;

if state=1 and puma= 200 then msa=1000; 
else if state= 1 and puma= 800 then msa=5160; 
else if state= 1 and puma=1100 then msa=2180; 
else if state= 1 and puma=1500 then msa=5240; 
else if state= 1 and puma=2000 then msa=2880; 
else if state= 1 and puma=2300 then msa=3440; 
else if state= 5 and puma= 800 then msa=2720; 
else if state= 5 and puma=1300 then msa=6240; 
else if state= 5 and puma=1600 then msa=4400; 
else if state= 8 and puma=1400 then msa=2080; 
else if state= 9 and puma= 200 then msa=3280; 
else if state= 9 and puma= 600 then msa=1170; 
else if state= 9 and puma= 900 then msa=3280; 
else if state= 9 and puma=1200 then msa=8040; 
else if state= 9 and puma=1400 then msa=5760; 
else if state= 9 and puma=1500 then msa=1160; 
else if state= 9 and puma=1900 then msa=8880; 
else if state= 9 and puma=2100 then msa=5480; 
else if state= 9 and puma=2200 then msa=5480; 
else if state= 9 and puma=2500 then msa=5020; 
else if state= 9 and puma=2600 then msa=5520; 
else if state=12 and puma= 200 then msa=3600; 
else if state=12 and puma= 300 then msa=2750; 
else if state=12 and puma= 400 then msa=6015; 
else if state=12 and puma= 600 then msa=8240; 
else if state=12 and puma=2400 then msa=5345; 
else if state=13 and puma= 200 then msa= 120; 
else if state=13 and puma= 600 then msa= 520; 
else if state=13 and puma= 800 then msa= 520; 
else if state=13 and puma= 900 then msa= 500; 
else if state=13 and puma=2900 then msa=1800; 
else if state=13 and puma=3000 then msa= 520; 
else if state=13 and puma=3100 then msa=4680; 
else if state=17 and puma=2900 then msa=3740; 
else if state=18 and puma=2400 then msa=2440; 
else if state=20 and puma=1100 then msa=3760; 
else if state=20 and puma=1400 then msa=8440; 
else if state=20 and puma=1500 then msa=4150; 
else if state=21 and puma=1100 then msa=3400; 
else if state=21 and puma=1400 then msa=1640; 
else if state=21 and puma=1600 then msa=4280; 
else if state=21 and puma=1900 then msa=4520; 
else if state=22 and puma= 700 then msa=3960; 
else if state=22 and puma=1700 then msa=5560; 
else if state=22 and puma=2300 then msa=5560; 
else if state=23 and puma= 500 then msa=4240; 
else if state=23 and puma= 600 then msa=6400; 
else if state=24 and puma= 100 then msa=1900; 
else if state=25 and puma= 100 then msa=6320; 
else if state=25 and puma= 700 then msa=8000; 
else if state=25 and puma=1000 then msa=9240; 
else if state=25 and puma=1100 then msa=9240; 
else if state=25 and puma=1200 then msa=2600; 
else if state=25 and puma=1700 then msa=4160; 
else if state=25 and puma=3800 then msa=1200; 
else if state=25 and puma=4200 then msa=6060; 
else if state=25 and puma=4300 then msa=5400; 
else if state=26 and puma=1200 then msa=5320; 
else if state=26 and puma=2200 then msa=2160; 
else if state=27 and puma= 900 then msa=5120; 
else if state=28 and puma=1000 then msa=3560; 
else if state=29 and puma= 200 then msa=7000; 
else if state=30 and puma= 400 then msa=3040; 
else if state=32 and puma= 400 then msa=6720; 
else if state=33 and puma= 400 then msa=6450; 
else if state=33 and puma= 601 then msa=4160; 
else if state=33 and puma= 602 then msa=6450; 
else if state=34 and puma= 300 then msa= 560; 
else if state=34 and puma=4000 then msa=5640; 
else if state=36 and puma= 600 then msa=8680; 
else if state=36 and puma= 700 then msa=2975; 
else if state=36 and puma=1400 then msa=8160; 
else if state=36 and puma=3400 then msa=2335; 
else if state=36 and puma=4000 then msa=6460; 
else if state=37 and puma= 700 then msa=3290; 
else if state=37 and puma=1200 then msa=1520; 
else if state=37 and puma=2200 then msa=3120; 
else if state=37 and puma=2400 then msa=6640; 
else if state=38 and puma= 400 then msa=2520; 
else if state=38 and puma= 500 then msa=2985; 
else if state=39 and puma=2000 then msa=8080; 
else if state=39 and puma=2500 then msa=9000; 
else if state=39 and puma=2900 then msa=6020; 
else if state=39 and puma=3500 then msa=3400; 
else if state=41 and puma=1000 then msa=6440; 
else if state=42 and puma=1400 then msa=6280; 
else if state=42 and puma=3800 then msa= 845; 
else if state=44 and puma= 400 then msa=6480; 
else if state=44 and puma= 600 then msa=6480; 
else if state=44 and puma= 700 then msa=6480; 
else if state=44 and puma= 800 then msa=6060; 
else if state=45 and puma= 100 then msa=3160; 
else if state=46 and puma= 100 then msa=6660; 
else if state=46 and puma= 500 then msa=7760; 
else if state=48 and puma= 700 then msa=7640; 
else if state=48 and puma= 900 then msa=8360; 
else if state=48 and puma=1800 then msa=2800; 
else if state=48 and puma=3500 then msa=7200; 
else if state=48 and puma=3900 then msa=4080; 
else if state=48 and puma=4600 then msa=7240; 
else if state=49 and puma= 200 then msa=7160; 
else if state=49 and puma= 300 then msa=7160; 
else if state=50 and puma= 100 then msa=1305; 
else if state=51 and puma= 500 then msa=6800; 
else if state=51 and puma=1300 then msa=1540; 
else if state=51 and puma=1400 then msa=4640; 
else if state=51 and puma=2400 then msa=6760; 
else if state=51 and puma=2800 then msa=5720; 
else if state=51 and puma=3300 then msa=5720; 
else if state=54 and puma= 100 then msa=9000; 
else if state=54 and puma= 300 then msa=6020; 
else if state=54 and puma= 700 then msa=1480; 
else if state=54 and puma= 800 then msa=3400; 
else if state=55 and puma=1300 then msa=3870; 
else if state=56 and puma= 100 then msa=1580; 
else if state=56 and puma= 200 then msa=1350;  





*step 2 -- hand entered fixups for top 125 cities;

if state=35 and puma=300 then msa=200;
if state=34 and msa=240 then msa=9999;
if state=26 and msa in (4300, 2900) then msa=440;
if state=13 and msa in (600, 2500) then msa=520;
if state=48 and puma=5200 then msa=640;
if state=1  and puma=200 then msa=9999;
if state=16 and puma=200 then msa=1080;
if msa=5700 then msa=1280;
if msa=3690 then msa=1600;
if msa=3965 then msa=1600;
if msa=620  then msa=1600;
if state=17 and puma=3600 then msa=1600;
if state=21 and puma=1400 then msa=1640;
if msa=4440  then msa=1680;
if state=39 and puma=400 then msa=1680;

if state=48 and puma=1400 then msa=1920;
if state=18 and puma=2700 then msa=2760;
if state=48 and puma=1800 then msa=2800;
if state=6  and puma=2700 then msa=2840;
if state=26 and puma=1200 then msa=3000;
if state=37 and puma=1700 then msa=3120;
if state=45 and puma=2100 then msa=3160;
if msa=1170  then msa=3280;
if msa=5020  then msa=3280;
if msa=5440  then msa=3280;
if state=18 and puma=2200 then msa=3480;
if msa=400  then msa=3480;

if state=26 and puma in (2400,2600) then msa=3720;
if msa=780 then msa=3720;
if state=4 and puma=300 then msa=4120;
if state=27 and puma=900 then msa=5120;
if state=22 and puma in (2300,1700) then msa=5560;

if state=34 and puma=4000 then msa=5640;
if state=51 and puma=2800 then msa=5720;
if msa=360  then msa=5945;
if state=12 and puma=1500 then msa=5960;
if state=4  and puma=700 then msa=6200;
if msa=845  then msa=6280;
if state=42 and puma in (1500,3800) then msa=6280;
if msa=8725  then msa=6440;
if state=53 and puma in (1901, 1902) then msa=6440;
if msa in (2480,6060) then msa=6480;
if state=37 and puma in (2400, 2600) then msa=6640;
if state=36 and puma=2200 then msa=6840;

if state=6  and puma=1000 then msa=9999;
if state=48 and puma=4600 then msa=7240;
if state=12 and puma in (3101, 3102) then msa=7510;
if state=42 and puma=3200 then msa=9999;
if state=25 and puma=500 then msa=8000;
if state=36 and puma=1800 then msa=8160;
if msa=6000 then msa=8735;
if state=51 and puma in (1200,2200) then msa=8840;
if state=54 and puma=500 then msa=8840;
if state=39 and puma=1500 then msa=9320;
if msa=7090 then msa=1120;



*identify top 125 cities;
top125=0;
if msa=80  then top125=1;
else if msa=160  then top125=1;
else if msa=200  then top125=1;
else if msa=240  then top125=1;
else if msa=440  then top125=1;
else if msa=520  then top125=1;
else if msa=600  then top125=1;
else if msa=640  then top125=1;
else if msa=680  then top125=1;
else if msa=720  then top125=1;
else if msa=760  then top125=1;
else if msa=875  then top125=1;
else if msa=1000  then top125=1;
else if msa=1080  then top125=1;
else if msa=1120  then top125=1;
else if msa=1160  then top125=1;
else if msa=1280  then top125=1;
else if msa=1440  then top125=1;
else if msa=1520  then top125=1;
else if msa=1560  then top125=1;
else if msa=1600  then top125=1;
else if msa=1640  then top125=1;
else if msa=1680  then top125=1;
else if msa=1720  then top125=1;
else if msa=1760  then top125=1;
else if msa=1840  then top125=1;
else if msa=1920  then top125=1;
else if msa=2000  then top125=1;
else if msa=2020  then top125=1;
else if msa=2080  then top125=1;
else if msa=2120  then top125=1;
else if msa=2160  then top125=1;
else if msa=2320  then top125=1;
else if msa=2640  then top125=1;
else if msa=2680  then top125=1;
else if msa=2700  then top125=1;
else if msa=2760  then top125=1;
else if msa=2800  then top125=1;
else if msa=2840  then top125=1;
else if msa=2960  then top125=1;
else if msa=3000  then top125=1;
else if msa=3120  then top125=1;
else if msa=3160  then top125=1;
else if msa=3240  then top125=1;
else if msa=3280  then top125=1;
else if msa=3320  then top125=1;
else if msa=3360  then top125=1;
else if msa=3480  then top125=1;
else if msa=3560  then top125=1;
else if msa=3600  then top125=1;
else if msa=3640  then top125=1;
else if msa=3660  then top125=1;
else if msa=3720  then top125=1;
else if msa=3760  then top125=1;
else if msa=3840  then top125=1;
else if msa=3980  then top125=1;
else if msa=4000  then top125=1;
else if msa=4040  then top125=1;
else if msa=4120  then top125=1;
else if msa=4280  then top125=1;
else if msa=4400  then top125=1;
else if msa=4480  then top125=1;
else if msa=4520  then top125=1;
else if msa=4720  then top125=1;
else if msa=4880  then top125=1;
else if msa=4900  then top125=1;
else if msa=4920  then top125=1;
else if msa=5000  then top125=1;
else if msa=5015  then top125=1;
else if msa=5080  then top125=1;
else if msa=5120  then top125=1;
else if msa=5160  then top125=1;
else if msa=5170  then top125=1;
else if msa=5190  then top125=1;
else if msa=5360  then top125=1;
else if msa=5380  then top125=1;
else if msa=5480  then top125=1;
else if msa=5560  then top125=1;
else if msa=5600  then top125=1;
else if msa=5640  then top125=1;
else if msa=5720  then top125=1;
else if msa=5775  then top125=1;
else if msa=5880  then top125=1;
else if msa=5920  then top125=1;
else if msa=5945  then top125=1;
else if msa=5960  then top125=1;
else if msa=6080  then top125=1;
else if msa=6160  then top125=1;
else if msa=6200  then top125=1;
else if msa=6280  then top125=1;
else if msa=6440  then top125=1;
else if msa=6480  then top125=1;
else if msa=6640  then top125=1;
else if msa=6760  then top125=1;
else if msa=6780  then top125=1;
else if msa=6840  then top125=1;
else if msa=6920  then top125=1;
else if msa=7040  then top125=1;
else if msa=7160  then top125=1;
else if msa=7240  then top125=1;
else if msa=7320  then top125=1;
else if msa=7360  then top125=1;
else if msa=7400  then top125=1;
else if msa=7440  then top125=1;
else if msa=7500  then top125=1;
else if msa=7510  then top125=1;
else if msa=7560  then top125=1;
else if msa=7600  then top125=1;
else if msa=7840  then top125=1;
else if msa=8000  then top125=1;
else if msa=8120  then top125=1;
else if msa=8160  then top125=1;
else if msa=8200  then top125=1;
else if msa=8280  then top125=1;
else if msa=8400  then top125=1;
else if msa=8520  then top125=1;
else if msa=8560  then top125=1;
else if msa=8720  then top125=1;
else if msa=8735  then top125=1;
else if msa=8840  then top125=1;
else if msa=8960  then top125=1;
else if msa=9040  then top125=1;
else if msa=9160  then top125=1;
else if msa=9240  then top125=1;
else if msa=9320  then top125=1;



